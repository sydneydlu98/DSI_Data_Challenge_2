---
title: "DSI_Data_Challenge"
author: "Dingxin Lu"
date: "10/10/2021"
output:
  html_document:
    toc: true
    toc_float: true
---
[my github link] https://github.com/sydneydlu98/DSI_Data_Challenge_2

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

*Prep* 
```{r, message=FALSE}
# load all the packages
library(here)
library(readxl)
library(dplyr)
library(tidyverse)
library(janitor)
library(lubridate) 
library(tidyr)
library(stringr)
library(readr)

# Read in the data from each of the three trash wheels
Mr_Trash_Wheel <- read_excel("Data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
    sheet = "Mr. Trash Wheel")

Professor_Trash_Wheel <- read_excel("Data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
    sheet = "Professor Trash Wheel")

Captain_Trash_Wheel <- read_excel("Data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
    sheet = "Captain Trash Wheel")
```

## Problem 1

**We will be working with data from Mr. Trash Wheel, a water wheel trash collection device that removed trash from the Inner Harbor in Baltimore, Maryland. There are three trash wheels we will be exploring (Mr. Trash Wheel, Professor Trash Wheel, and Captain Trash Wheel). I have provided you the data for this on Canvas in the Excel spreadsheet titled Trash-Wheel-Collection-Totals-8-6-19.xlsx.**

```{r}
Mr_Trash_Wheel_clean <- Mr_Trash_Wheel %>%
  clean_names() %>%
  filter(is.na(dumpster) == "FALSE") %>%
  mutate(wheel = "Mr. Trash Wheel") %>%
  select(-x15, -x16, -x17) 

Professor_Trash_Wheel_clean <- Professor_Trash_Wheel %>%
  clean_names() %>% 
  filter(is.na(dumpster) == "FALSE") %>%
  mutate(wheel = "Professor Trash Wheel")
  
Captain_Trash_Wheel_clean <- Captain_Trash_Wheel %>%
  clean_names() %>% 
  filter(is.na(dumpster) == "FALSE") %>%
  mutate(wheel = "Captain Trash Wheel")
   
## bind the three dataframes together into a dataframe
all_trash_wheels <- bind_rows(list(Mr_Trash_Wheel_clean, Professor_Trash_Wheel_clean, Captain_Trash_Wheel_clean))

all_trash_wheels_UPDATED <- all_trash_wheels %>%
  pivot_longer(col = plastic_bottles:homes_powered,
               names_to = 'trash_type', 
               values_to = 'number') %>%
  ## Use stringr::str_replace and stringr::str_to_title to format the column trash_type for plotting
  filter(month == "June" & year == 2018) %>%
  group_by(wheel, trash_type) %>%
  summarise(amount_trash = sum(number))

ggplot(all_trash_wheels_UPDATED) +
  geom_bar(aes(x = amount_trash)) +
  facet_wrap( ~ trash_type) +
  labs(x ='Amount of trash',
       y ='Wheel',
       title ='Amount of trash collected by each wheel')

```

## Problem 2

**Next we will be examining data from FiveThirtyEight on the S&P closing prices and the unemployment rate. For this problem, the data is provided on Canvas. You will need snp.csv and unemployment.csv.**
```{r}
## load both data
snp <- read_csv("Data/snp.csv")
unemployment <- read_csv("Data/unemployment.csv")
```

```{r}
snp_UPDATED <- snp %>%
  mutate(date = mdy(date)) %>%
  mutate(year = year(date)) %>%
  mutate(month = month(date, label=TRUE))
```

```{r}
unemployment_UPDATED <- unemployment %>%
  pivot_longer(everything(),
               names_to = "time", 
               values_to = "number")
```

## Problem 3

**Next we will examine the direct relationship between the S&P closing prices and the unemployment rate using data from 2000 and onward in a scatterplot.**
```{r}

```

## Problem 4

**Write a paragraph (at least 5 sentences) describing what you observed in the plots in Problems 2 & 3.**

